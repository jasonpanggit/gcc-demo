/**
 * EOL Utilities - Backward Compatibility Wrapper
 * Loads ES module and exposes to global scope
 * @deprecated Use ES module import instead
 */

(async function() {
    'use strict';

    try {
        // Import ES module
        const eolUtils = await import('./modules/eol-utils.js');

        // Expose to window for backward compatibility
        window.eolUtils = eolUtils.default;

        // Individual function exports
        window.cleanSoftwareName = eolUtils.cleanSoftwareName;
        window.parseVersionFromName = eolUtils.parseVersionFromName;
        window.getSelectedAgents = eolUtils.getSelectedAgents;
        window.formatDate = eolUtils.formatDate;
        window.formatRelativeTime = eolUtils.formatRelativeTime;
        window.escapeHtml = eolUtils.escapeHtml;
        window.debounce = eolUtils.debounce;
        window.showToast = eolUtils.showToast;
        window.copyToClipboard = eolUtils.copyToClipboard;
        window.createSpinner = eolUtils.createSpinner;
        window.createLoadingOverlay = eolUtils.createLoadingOverlay;
        window.createModal = eolUtils.createModal;
        window.lazyLoad = eolUtils.lazyLoad;
        window.deferUntilIdle = eolUtils.deferUntilIdle;
        window.preload = eolUtils.preload;
        window.daysUntilEOL = eolUtils.daysUntilEOL;
        window.getRiskLevel = eolUtils.getRiskLevel;
        window.getRiskBadgeClass = eolUtils.getRiskBadgeClass;

        console.log('✅ EOL Utilities (ES Module) loaded successfully');

    } catch (error) {
        console.error('❌ Failed to load EOL Utilities ES module:', error);
        console.error('Falling back to inline implementation...');

        // Minimal fallback
        window.eolUtils = {
            cleanSoftwareName: (name) => name,
            formatDate: (date) => date || 'N/A',
            escapeHtml: (text) => text,
            showToast: (msg) => console.log('Toast:', msg)
        };
    }
})();
